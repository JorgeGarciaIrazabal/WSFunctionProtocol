<!DOCTYPE html>
<html>
<head>
    <title>tornado WebSocket example</title>
    <script type="text/javascript" src="static/WSProtocol.js"></script>
</head>
<body>
<div class="container">
    <h1>tornado WebSocket example with WSFunctionProtocol</h1>
    <hr>
    WebSocket status : <span id="message">"Waiting connection</span>
</div>


    <script>
    $tornadoInit('ws://localhost:8888/')
    //$tornado.TestClass.client.test = 6
    $tornado.client.ChatHub.alert = function(message){
        alert(message)
    }
    //alert($tornado.client["TestClass"]["test"])
    $tornado.onopen = function(){
        document.getElementById("message").innerHTML = "Connected"
      $tornado.server.ChatHub.getNumOfClientsConnected().done(function(data){
        console.log(data)
      }, function(error){
        console.log("Error on - " + error)
      });
      console.log("send1")
      $tornado.server.ChatHub.sendToAll("this is great").done(function(data){
        console.log(2)
      }, function(error){
      console.log("Error on - " + error)
      });console.log("send2")
    };

    $tornado.onclose = function(ev){
        document.getElementById("message").innerHTML = "Closed"
     console.log("OnClose")
    };
    $tornado.onerror = function(ev){
      alert(ev)
    };


</script>
</body>
</html>
